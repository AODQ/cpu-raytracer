#include <glm/glm.hpp>
#include <spdlog/spdlog.h>

#include <fstream>
#include <string>

////////////////////////////////////////////////////////////////////////////////
struct Buffer {
  Buffer() = default;
private:
  std::vector<glm::vec3> data;
  size_t width, height;

public:
  static Buffer Construct(size_t width, size_t height) {
    Buffer self;
    self.width = width; self.height = height;
    self.data.resize(width*height);
    return self;
  }

  size_t Width() const { return this->width; }
  size_t Height() const { return this->height; }
  glm::vec2 Dim() const { return glm::vec2(this->width, this->height); }

  glm::vec3 & At(size_t x, size_t y) {
    return this->data[y*this->width + x];
  }

  glm::vec3 const & At(size_t x, size_t y) const {
    return this->data[y*this->width + x];
  }

  glm::vec3 & At(size_t it) { return this->At(it%this->width, it/this->width); }
  glm::vec3 const & At(size_t it) const {
    return this->At(it%this->width, it/this->width);
  }
};

////////////////////////////////////////////////////////////////////////////////
void SaveImage(std::string const & filename, Buffer const & data) {
  auto file = std::ofstream{filename, std::ios::binary};
  spdlog::info("Saving image {}", filename);
  file << "P6\n" << data.Width() << " " << data.Height() << "\n255\n";
  for (size_t i = 0u; i < data.Height()*data.Width(); ++ i) {
    glm::vec3 pixel = data.At(i);
    pixel = 255.0f * glm::clamp(pixel, glm::vec3(0.0f), glm::vec3(1.0f));
    file
      << static_cast<uint8_t>(pixel.x)
      << static_cast<uint8_t>(pixel.y)
      << static_cast<uint8_t>(pixel.z)
    ;
  }
  spdlog::info("Finished saving image {}", filename);
}

////////////////////////////////////////////////////////////////////////////////
struct Triangle { glm::vec3 a, b, c; };

////////////////////////////////////////////////////////////////////////////////
enum class CullFace { None, Front, Back };

////////////////////////////////////////////////////////////////////////////////
bool RayTriangleIntersection(
  glm::vec3 ori
, glm::vec3 dir
, Triangle const & triangle
, float & distance
, glm::vec2 & uvCoords
, CullFace cullFace = CullFace::None
, float epsilon = 0.00001f
) {
  glm::vec3 ab = triangle.b - triangle.a;
  glm::vec3 ac = triangle.c - triangle.a;
  glm::vec3 pvec = glm::cross(dir, ac);
  float determinant = glm::dot(ab, pvec);

  if ((cullFace == CullFace::None  && glm::abs(determinant) <  epsilon)
   || (cullFace == CullFace::Back  &&          determinant  <  epsilon)
   || (cullFace == CullFace::Front &&          determinant  > -epsilon)
  ) {
    return false;
  }

  float determinantInv = 1.0f / determinant;

  glm::vec3 tvec = ori - triangle.a;
  uvCoords.x = determinantInv * glm::dot(tvec, pvec);
  if (uvCoords.x < 0.0f || uvCoords.x > 1.0f) { return false; }

  glm::vec3 qvec = glm::cross(tvec, ab);
  uvCoords.y = determinantInv * glm::dot(dir, qvec);
  if (uvCoords.y < 0.0f || uvCoords.y > 1.0f) { return false; }

  distance = determinantInv * glm::dot(ac, qvec);
  return true;
}

////////////////////////////////////////////////////////////////////////////////
glm::vec3 LookAt(glm::vec3 ori, glm::vec2 uv) {
  glm::vec3
    ww = glm::normalize(-ori),
    uu = glm::normalize(glm::cross(ww, glm::vec3(0.0, 1.0, 0.0))),
    vv = glm::normalize(glm::cross(uu, ww));
  return glm::normalize(glm::mat3(uu, vv, ww)*glm::vec3(uv.x, uv.y, 2.0f));
}

#define I(v0x, v0y, v0z, v1x, v1y, v1z, v2x, v2y, v2z) \
  Triangle {                                           \
    glm::vec3(v0x, v0y, v0z),                          \
    glm::vec3(v1x, v1y, v1z),                          \
    glm::vec3(v2x, v2y, v2z)                           \
  }

////////////////////////////////////////////////////////////////////////////////
std::vector<Triangle> triangles = {

  I(-1.0f,-1.0f,-1.0f, -1.0f,-1.0f, 1.0f, -1.0f, 1.0f, 1.0f),
  I( 1.0f, 1.0f,-1.0f, -1.0f,-1.0f,-1.0f, -1.0f, 1.0f,-1.0f),
  I( 1.0f,-1.0f, 1.0f, -1.0f,-1.0f,-1.0f, 1.0f,-1.0f,-1.0f),
  I( 1.0f, 1.0f,-1.0f, 1.0f,-1.0f,-1.0f, -1.0f,-1.0f,-1.0f),
  I( -1.0f,-1.0f,-1.0f, -1.0f, 1.0f, 1.0f, -1.0f, 1.0f,-1.0f),
  I( 1.0f,-1.0f, 1.0f, -1.0f,-1.0f, 1.0f, -1.0f,-1.0f,-1.0f),
  I( -1.0f, 1.0f, 1.0f, -1.0f,-1.0f, 1.0f, 1.0f,-1.0f, 1.0f),
  I( 1.0f, 1.0f, 1.0f, 1.0f,-1.0f,-1.0f, 1.0f, 1.0f,-1.0f),
  I( 1.0f,-1.0f,-1.0f, 1.0f, 1.0f, 1.0f, 1.0f,-1.0f, 1.0f),
  I( 1.0f, 1.0f, 1.0f, 1.0f, 1.0f,-1.0f, -1.0f, 1.0f,-1.0f),
  I( 1.0f, 1.0f, 1.0f, -1.0f, 1.0f,-1.0f, -1.0f, 1.0f, 1.0f),
  I( 1.0f, 1.0f, 1.0f, -1.0f, 1.0f, 1.0f, 1.0f,-1.0f, 1.0f),


  /* I(61.099873, 32.911991, -8.080328, 71.082626, 51.572910, -0.000000, 62.879616, 30.167408, -0.000000), */
  /* I(68.493912, 52.017307, -4.479231, 71.082626, 51.572910, -0.000000, 61.099873, 32.911991, -8.080328), */
  /* I(68.493912, 52.017307, -4.479231, 82.293999, 59.288723, -0.000000, 71.082626, 51.572910, -0.000000), */
  /* I(68.493912, 52.017307, -4.479231, 61.099873, 32.911991, -8.080328, 63.504601, 55.494896, -2.576819), */
  /* I(-66.952492, 41.298553, -4.100434, -65.562416, 43.174149, 0.000000, -60.090996, 48.291927, -0.000000), */
  /* I(-67.541267, 48.171173, -4.120241, -66.952492, 41.298553, -4.100434, -60.090996, 48.291927, -0.000000), */
  /* I(-60.731197, 28.673861, -4.142333, -65.562416, 43.174149, 0.000000, -66.952492, 41.298553, -4.100434), */
  /* I(-65.562416, 43.174149, 0.000000, -60.731197, 28.673861, -4.142333, -60.005768, 29.797796, -0.000000), */
  /* I(32.891766, 2.704291, 13.994600, 27.166487, 1.863880, 21.020367, 33.011635, 1.863880, -9.187500), */
  /* I(13.994604, 2.704291, -32.891766, 21.020367, 1.863880, -27.166487, -4.698298, 1.863880, -33.908211), */
  /* I(39.847095, 14.462756, 23.403347, 17.386553, 1.863880, 29.602753, 27.166487, 1.863880, 21.020367), */
  /* I(32.891766, 2.704291, 13.994600, 39.847095, 14.462756, 23.403347, 27.166487, 1.863880, 21.020367), */
  /* I(43.031223, 10.766197, 5.962375, 32.891766, 2.704291, 13.994600, 33.011635, 1.863880, -9.187500), */
  /* I(0.000009, 14.462756, -46.056156, -4.698298, 1.863880, -33.908211, -12.035506, 12.514625, -43.244812), */
  /* I(36.567734, 14.462756, -28.294683, 28.294683, 14.462756, -36.567726, 33.861748, 18.983082, -33.861748), */
  /* I(43.395134, 16.616825, -18.463511, 36.567734, 14.462756, -28.294683, 33.861748, 18.983082, -33.861748), */
  /* I(41.361908, 24.300135, -24.293045, 46.472443, 22.931341, -11.406939, 43.395134, 16.616825, -18.463511), */
  /* I(33.861748, 18.983082, -33.861748, 41.361908, 24.300135, -24.293045, 43.395134, 16.616825, -18.463511), */
  /* I(24.293045, 24.300138, -41.361916, 33.861748, 18.983082, -33.861748, 28.294683, 14.462756, -36.567726), */
  /* I(6.548908, 18.983082, -47.264248, 24.293045, 24.300138, -41.361916, 28.294683, 14.462756, -36.567726), */
  /* I(6.548908, 18.983082, -47.264248, 28.294683, 14.462756, -36.567726, 0.000009, 14.462756, -46.056156), */
  /* I(43.031223, 10.766197, 5.962375, 33.011635, 1.863880, -9.187500, 43.395134, 16.616825, -18.463511), */
  /* I(43.395134, 16.616825, -18.463511, 33.011635, 1.863880, -9.187500, 36.567734, 14.462756, -28.294683), */
  /* I(46.791389, 17.264900, -6.503068, 43.031223, 10.766197, 5.962375, 43.395134, 16.616825, -18.463511), */
  /* I(46.682999, 15.834087, -0.000000, 43.031223, 10.766197, 5.962375, 46.791389, 17.264900, -6.503068), */
  /* I(46.791389, 17.264900, -6.503068, 43.395134, 16.616825, -18.463511, 46.472443, 22.931341, -11.406939), */
  /* I(36.567734, 14.462756, -28.294683, 33.011635, 1.863880, -9.187500, 21.020367, 1.863880, -27.166487), */
  /* I(36.567734, 14.462756, -28.294683, 21.020367, 1.863880, -27.166487, 28.294683, 14.462756, -36.567726), */
  /* I(13.994604, 2.704291, -32.891766, 28.294683, 14.462756, -36.567726, 21.020367, 1.863880, -27.166487), */
  /* I(0.000009, 14.462756, -46.056156, 28.294683, 14.462756, -36.567726, 13.994604, 2.704291, -32.891766), */
  /* I(0.000009, 14.462756, -46.056156, 13.994604, 2.704291, -32.891766, -4.698298, 1.863880, -33.908211), */
  /* I(-35.655033, 2.704291, -0.000000, -33.011635, 1.863880, -9.187503, -34.215515, 1.863880, -0.000000), */
  /* I(-44.821884, 12.514625, -0.000000, -33.011635, 1.863880, -9.187503, -35.655033, 2.704291, -0.000000), */
  /* I(-67.487587, 33.633667, 4.792836, -67.331070, 30.270945, -1.647539, -56.810913, 22.241756, -4.792836), */
  /* I(-67.487587, 33.633667, 4.792836, -56.810913, 22.241756, -4.792836, -60.150414, 23.426712, 2.995523), */
  /* I(-69.400368, 38.397537, -4.792836, -67.331070, 30.270945, -1.647539, -71.188026, 37.822628, -0.000000), */
  /* I(-67.331070, 30.270945, -1.647539, -69.400368, 38.397537, -4.792836, -56.810913, 22.241756, -4.792836), */
  /* I(-60.150414, 23.426712, 2.995523, -56.810913, 22.241756, -4.792836, -46.212391, 14.804548, -0.000000), */
  /* I(-60.150414, 23.426712, 2.995523, -46.212391, 14.804548, -0.000000, -46.920513, 17.424940, 5.242165), */
  /* I(-58.978504, 25.694927, 5.391940, -60.150414, 23.426712, 2.995523, -46.920513, 17.424940, 5.242165), */
  /* I(6.548908, 18.983082, -47.264248, 0.000009, 14.462756, -46.056156, -6.581274, 21.567760, -47.497890), */
  /* I(-6.581274, 21.567760, -47.497890, 0.000009, 14.462756, -46.056156, -18.719345, 18.983080, -43.996426), */
  /* I(0.000009, 14.462756, -46.056156, -12.035506, 12.514625, -43.244812, -18.719345, 18.983080, -43.996426), */
  /* I(-12.035506, 12.514625, -43.244812, -4.698298, 1.863880, -33.908211, -26.675900, 10.766197, -34.475636), */
  /* I(-12.035506, 12.514625, -43.244812, -26.675900, 10.766197, -34.475636, -28.899599, 16.616825, -37.349522), */
  /* I(0.000009, 29.964584, 46.898643, 0.000009, 16.616825, 47.040791, 18.719349, 18.983082, 43.996426), */
  /* I(24.293045, 24.300138, 41.361916, 0.000009, 29.964584, 46.898643, 18.719349, 18.983082, 43.996426), */
  /* I(37.679852, 27.101158, 29.155201, 21.591206, 58.824570, 27.904232, 24.293045, 24.300138, 41.361916), */
  /* I(24.293045, 24.300138, 41.361916, 18.719349, 18.983082, 43.996426, 33.398964, 16.616825, 33.398964), */
  /* I(37.679852, 27.101158, 29.155201, 24.293045, 24.300138, 41.361916, 33.398964, 16.616825, 33.398964), */
  /* I(37.679852, 27.101158, 29.155201, 33.398964, 16.616825, 33.398964, 41.466896, 21.567759, 24.354704), */
  /* I(37.679852, 27.101158, 29.155201, 41.466896, 21.567759, 24.354704, 41.735195, 35.853699, 17.757248), */
  /* I(41.735195, 35.853699, 17.757248, 41.466896, 21.567759, 24.354704, 46.228214, 25.222334, 11.731899), */
  /* I(46.228214, 25.222334, 11.731899, 41.466896, 21.567759, 24.354704, 39.847095, 14.462756, 23.403347), */
  /* I(46.228214, 25.222334, 11.731899, 39.847095, 14.462756, 23.403347, 46.791389, 17.264900, 6.503068), */
  /* I(41.466896, 21.567759, 24.354704, 33.398964, 16.616825, 33.398964, 39.847095, 14.462756, 23.403347), */
  /* I(46.682999, 15.834087, -0.000000, 46.791389, 17.264900, 6.503068, 43.031223, 10.766197, 5.962375), */
  /* I(46.791389, 17.264900, 6.503068, 39.847095, 14.462756, 23.403347, 43.031223, 10.766197, 5.962375), */
  /* I(43.031223, 10.766197, 5.962375, 39.847095, 14.462756, 23.403347, 32.891766, 2.704291, 13.994600), */
  /* I(33.398964, 16.616825, 33.398964, 17.386553, 1.863880, 29.602753, 39.847095, 14.462756, 23.403347), */
  /* I(18.719349, 18.983082, 43.996426, 12.035512, 12.514625, 43.244812, 33.398964, 16.616825, 33.398964), */
  /* I(0.000009, 16.616825, 47.040791, 12.035512, 12.514625, 43.244812, 18.719349, 18.983082, 43.996426), */
  /* I(12.035512, 12.514625, 43.244812, 17.386553, 1.863880, 29.602753, 33.398964, 16.616825, 33.398964), */
  /* I(0.000009, 16.616825, 47.040791, 0.000007, 1.863880, 34.215515, 12.035512, 12.514625, 43.244812), */
  /* I(0.000007, 1.863880, 34.215515, 17.386553, 1.863880, 29.602753, 12.035512, 12.514625, 43.244812), */
  /* I(-59.462814, 24.431885, 3.591738, -68.633446, 46.826305, 4.109865, -65.562416, 43.174149, 0.000000), */
  /* I(-60.005768, 29.797796, -0.000000, -59.462814, 24.431885, 3.591738, -65.562416, 43.174149, 0.000000), */
  /* I(-51.192345, 22.269619, 0.000000, -46.539436, 18.485825, 4.818050, -60.005768, 29.797796, -0.000000), */
  /* I(-51.192345, 22.269619, 0.000000, -47.478485, 20.951784, 0.000000, -46.539436, 18.485825, 4.818050), */
  /* I(0.000007, 1.863880, 34.215515, -17.592590, 12.514625, 41.348186, -13.994600, 2.704291, 32.891766), */
  /* I(0.000009, 16.616825, 47.040791, -17.592590, 12.514625, 41.348186, 0.000007, 1.863880, 34.215515), */
  /* I(0.000009, 16.616825, 47.040791, -18.719345, 18.983080, 43.996426, -17.592590, 12.514625, 41.348186), */
  /* I(-23.452677, 32.884178, 39.931087, -29.300041, 18.983082, 37.867046, -18.719345, 18.983080, 43.996426), */
  /* I(-23.452677, 32.884178, 39.931087, -18.719345, 18.983080, 43.996426, -12.392997, 32.884178, 44.529316), */
  /* I(-12.392997, 32.884178, 44.529316, -18.719345, 18.983080, 43.996426, 0.000009, 16.616825, 47.040791), */
  /* I(-12.392997, 32.884178, 44.529316, 0.000009, 16.616825, 47.040791, 0.000009, 29.964584, 46.898643), */
  /* I(-18.719345, 18.983080, -43.996426, -28.899599, 16.616825, -37.349522, -29.155201, 27.101158, -37.679852), */
  /* I(-29.155201, 27.101158, -37.679852, -28.899599, 16.616825, -37.349522, -38.054226, 21.567760, -29.444876), */
  /* I(-44.213909, 21.567760, -18.811884, -38.054226, 21.567760, -29.444876, -39.847099, 14.462756, -23.403353), */
  /* I(-47.147533, 18.284660, -5.391940, -44.213909, 21.567760, -18.811884, -39.847099, 14.462756, -23.403353), */
  /* I(-32.121395, 35.853699, -32.121395, -29.155201, 27.101158, -37.679852, -38.054226, 21.567760, -29.444876), */
  /* I(-44.213909, 21.567760, -18.811884, -47.147533, 18.284660, -5.391940, -46.898643, 29.964584, -0.000000), */
  /* I(-46.898643, 29.964584, -0.000000, -47.147533, 18.284660, -5.391940, -47.923016, 21.687986, -0.000000), */
  /* I(5.115779, 78.414864, -5.115779, 8.648290, 76.854973, 3.687933, 8.113047, 76.854965, -4.772230), */
  /* I(1.291645, 76.854980, -9.287611, 5.115779, 78.414864, -5.115779, 8.113047, 76.854965, -4.772230), */
  /* I(5.115779, 78.414864, -5.115779, -3.687933, 76.854973, 8.648291, 8.648290, 76.854973, 3.687933), */
  /* I(-5.412244, 77.735779, -6.989367, 5.115779, 78.414864, -5.115779, 1.291645, 76.854980, -9.287611), */
  /* I(-5.412244, 77.735779, -6.989367, -9.287612, 76.854958, 1.291646, -3.687933, 76.854973, 8.648291), */
  /* I(5.115779, 78.414864, -5.115779, -5.412244, 77.735779, -6.989367, -3.687933, 76.854973, 8.648291), */
  /* I(28.946297, 59.029552, 17.002151, 17.002172, 59.029549, 28.946333, 21.591206, 58.824570, 27.904232), */
  /* I(21.591206, 58.824570, 27.904232, 17.002172, 59.029549, 28.946333, 13.955686, 58.234821, 32.800297), */
  /* I(21.591206, 58.824570, 27.904232, 30.762415, 58.234821, 18.067652, 28.946297, 59.029552, 17.002151), */
  /* I(28.946297, 59.029552, 17.002151, 30.762415, 58.234821, 18.067652, 33.118683, 59.610893, 9.217291), */
  /* I(28.230707, 58.234829, -21.843819, 32.121395, 35.853699, -32.121395, 18.067656, 58.234821, -30.762419), */
  /* I(17.002172, 59.029549, -28.946333, 18.067656, 58.234821, -30.762419, 4.882355, 58.234821, -35.236530), */
  /* I(23.754915, 59.029526, -23.754915, 18.067656, 58.234821, -30.762419, 17.002172, 59.029549, -28.946333), */
  /* I(17.002172, 59.029549, -28.946333, 4.882355, 58.234821, -35.236530, 4.595192, 59.029648, -33.155777), */
  /* I(-4.698298, 1.863880, -33.908211, 21.020367, 1.863880, -27.166487, -17.386549, 1.863880, -29.602753), */
  /* I(33.011635, 1.863880, -9.187500, -14.216470, 0.308913, 14.216470, -17.386549, 1.863880, -29.602753), */
  /* I(17.386553, 1.863880, 29.602753, -21.020367, 1.863880, 27.166487, -14.216470, 0.308913, 14.216470), */
  /* I(-29.602753, 1.863880, 17.386553, -33.011635, 1.863880, -9.187503, -17.386549, 1.863880, -29.602753), */
  /* I(-33.011635, 1.863880, -9.187503, -27.166487, 1.863880, -21.020367, -17.386549, 1.863880, -29.602753), */
  /* I(23.754915, 59.029526, -23.754915, 34.304840, 58.234821, -9.547412, 28.230707, 58.234829, -21.843819), */
  /* I(28.230707, 58.234829, -21.843819, 34.304840, 58.234821, -9.547412, 45.739914, 29.668732, -10.426750), */
  /* I(23.754915, 59.029526, -23.754915, 28.230707, 58.234829, -21.843819, 18.067656, 58.234821, -30.762419), */
  /* I(4.882355, 58.234821, -35.236530, 18.067656, 58.234821, -30.762419, 12.148159, 35.853699, -43.649574), */
  /* I(-29.602753, 1.863880, 17.386553, -17.386549, 1.863880, -29.602753, -14.216470, 0.308913, 14.216470), */
  /* I(-5.412244, 77.735779, -6.989367, 1.291645, 76.854980, -9.287611, -3.604242, 75.812813, -8.452425), */
  /* I(-5.412244, 77.735779, -6.989367, -3.604242, 75.812813, -8.452425, -7.929260, 75.812790, -4.663979), */
  /* I(-9.287612, 76.854958, 1.291646, -5.412244, 77.735779, -6.989367, -7.929260, 75.812790, -4.663979), */
  /* I(17.386553, 1.863880, 29.602753, 0.000007, 1.863880, 34.215515, -21.020367, 1.863880, 27.166487), */
  /* I(-29.602753, 1.863880, 17.386553, -14.216470, 0.308913, 14.216470, -21.020367, 1.863880, 27.166487), */
  /* I(-34.215515, 1.863880, -0.000000, -33.011635, 1.863880, -9.187503, -29.602753, 1.863880, 17.386553), */
  /* I(21.020367, 1.863880, -27.166487, 33.011635, 1.863880, -9.187500, -17.386549, 1.863880, -29.602753), */
  /* I(33.011635, 1.863880, -9.187500, 27.166487, 1.863880, 21.020367, 17.386553, 1.863880, 29.602753), */
  /* I(17.386553, 1.863880, 29.602753, -14.216470, 0.308913, 14.216470, 33.011635, 1.863880, -9.187500), */
  /* I(-17.114241, 59.032356, 28.935152, -12.392997, 32.884178, 44.529316, -4.882612, 58.234821, 35.236534), */
  /* I(-0.000007, 60.534325, -33.104507, 19.548389, 61.291862, -25.264116, 13.174147, 59.642311, -30.963442), */
  /* I(13.174147, 59.642311, -30.963442, 19.548389, 61.291862, -25.264116, 26.649752, 59.642311, -20.620539), */
  /* I(19.548389, 61.291862, -25.264116, 33.104507, 60.534313, -0.000000, 26.649752, 59.642311, -20.620539), */
  /* I(26.649752, 59.642311, -20.620539, 33.104507, 60.534313, -0.000000, 33.263245, 59.642303, -4.608937), */
  /* I(33.104507, 60.534313, -0.000000, 30.963442, 59.642311, 13.174147, 33.263245, 59.642303, -4.608937), */
  /* I(30.963442, 59.642311, 13.174147, 7.343721, 62.511093, 26.386736, 13.174150, 59.642311, 30.963442), */
  /* I(-0.000007, 60.534325, -33.104507, 13.174147, 59.642311, -30.963442, -17.055843, 59.642311, -29.039686), */
  /* I(-33.124229, 59.610893, 9.217296, -25.245144, 58.234821, 25.244675, -26.634090, 59.032555, 20.547150), */
  /* I(-26.634090, 59.032555, 20.547150, -25.245144, 58.234821, 25.244675, -17.114241, 59.032356, 28.935152), */
  /* I(-17.114241, 59.032356, 28.935152, -4.882612, 58.234821, 35.236534, -4.651231, 59.029964, 33.154255), */
  /* I(17.002172, 59.029549, 28.946333, -4.651231, 59.029964, 33.154255, 13.955686, 58.234821, 32.800297), */
  /* I(13.955686, 58.234821, 32.800297, -4.651231, 59.029964, 33.154255, -4.882612, 58.234821, 35.236534), */
  /* I(-28.802830, 61.941803, -8.016142, -26.649752, 59.642315, -20.620541, -33.263245, 59.642303, 4.608937), */
  /* I(-28.802830, 61.941803, -8.016142, -17.055843, 59.642311, -29.039686, -26.649752, 59.642315, -20.620541), */
  /* I(57.087494, 39.099564, -6.817777, 63.504601, 55.494896, -2.576819, 55.738300, 27.643641, -10.413341), */
  /* I(61.099873, 32.911991, -8.080328, 55.738300, 27.643641, -10.413341, 63.504601, 55.494896, -2.576819), */
  /* I(45.739914, 29.668732, -10.426750, 57.087494, 39.099564, -6.817777, 55.738300, 27.643641, -10.413341), */
  /* I(46.472443, 22.931341, -11.406939, 45.739914, 29.668732, -10.426750, 55.738300, 27.643641, -10.413341), */
  /* I(46.472443, 22.931341, -11.406939, 55.738300, 27.643641, -10.413341, 57.434978, 23.215300, -5.950482), */
  /* I(46.472443, 22.931341, -11.406939, 57.434978, 23.215300, -5.950482, 46.791389, 17.264900, -6.503068), */
  /* I(55.738300, 27.643641, -10.413341, 61.099873, 32.911991, -8.080328, 62.879616, 30.167408, -0.000000), */
  /* I(55.738300, 27.643641, -10.413341, 62.879616, 30.167408, -0.000000, 57.434978, 23.215300, -5.950482), */
  /* I(46.791389, 17.264900, -6.503068, 57.434978, 23.215300, -5.950482, 57.851025, 22.129423, -0.000000), */
  /* I(46.682999, 15.834087, -0.000000, 46.791389, 17.264900, -6.503068, 57.851025, 22.129423, -0.000000), */
  /* I(57.434978, 23.215300, -5.950482, 62.879616, 30.167408, -0.000000, 57.851025, 22.129423, -0.000000), */
  /* I(-32.294113, 59.030373, -8.984767, -28.995920, 59.031895, -16.997307, -28.231087, 58.234821, -21.843819), */
  /* I(-33.456272, 59.029667, -0.000000, -32.294113, 59.030373, -8.984767, -33.624737, 59.873005, -0.000000), */
  /* I(-37.652912, 53.917545, -0.000000, -33.624737, 59.873005, -0.000000, -37.995636, 52.520027, -4.792836), */
  /* I(-33.624737, 59.873005, -0.000000, -32.294113, 59.030373, -8.984767, -37.995636, 52.520027, -4.792836), */
  /* I(-32.294113, 59.030373, -8.984767, -39.199642, 49.924068, -4.792836, -37.995636, 52.520027, -4.792836), */
  /* I(-17.478430, 59.610886, -29.698744, -17.114241, 59.032356, -28.935152, -4.882612, 58.234821, -35.236534), */
  /* I(-28.231087, 58.234821, -21.843819, -17.478430, 59.610886, -29.698744, -32.121395, 35.853699, -32.121395), */
  /* I(-4.882612, 58.234821, -35.236534, 4.882355, 58.234821, -35.236530, -6.337523, 32.884182, -45.738712), */
  /* I(12.148159, 35.853699, -43.649574, -6.337523, 32.884182, -45.738712, 4.882355, 58.234821, -35.236530), */
  /* I(18.067656, 58.234821, -30.762419, 24.293045, 24.300138, -41.361916, 12.148159, 35.853699, -43.649574), */
  /* I(32.121395, 35.853699, -32.121395, 24.293045, 24.300138, -41.361916, 18.067656, 58.234821, -30.762419), */
  /* I(-18.626810, 27.101158, -43.778934, -4.882612, 58.234821, -35.236534, -6.337523, 32.884182, -45.738712), */
  /* I(-17.478430, 59.610886, -29.698744, -4.882612, 58.234821, -35.236534, -18.626810, 27.101158, -43.778934), */
  /* I(-17.478430, 59.610886, -29.698744, -18.626810, 27.101158, -43.778934, -32.121395, 35.853699, -32.121395), */
  /* I(-28.231087, 58.234821, -21.843819, -40.759697, 38.866898, -17.342207, -32.294113, 59.030373, -8.984767), */
  /* I(-28.231087, 58.234821, -21.843819, -32.121395, 35.853699, -32.121395, -40.759697, 38.866898, -17.342207), */
  /* I(-32.121395, 35.853699, -32.121395, -18.626810, 27.101158, -43.778934, -29.155201, 27.101158, -37.679852), */
  /* I(-32.121395, 35.853699, -32.121395, -38.054226, 21.567760, -29.444876, -40.759697, 38.866898, -17.342207), */
  /* I(-40.759697, 38.866898, -17.342207, -38.054226, 21.567760, -29.444876, -44.213909, 21.567760, -18.811884), */
  /* I(-40.759697, 38.866898, -17.342207, -44.213909, 21.567760, -18.811884, -46.898643, 29.964584, -0.000000), */
  /* I(-32.294113, 59.030373, -8.984767, -40.759697, 38.866898, -17.342207, -39.199642, 49.924068, -4.792836), */
  /* I(-39.199642, 49.924068, -4.792836, -40.759697, 38.866898, -17.342207, -46.898643, 29.964584, -0.000000), */
  /* I(-39.199642, 49.924068, -4.792836, -46.898643, 29.964584, -0.000000, -40.153595, 48.526070, -0.000000), */
  /* I(-26.675900, 10.766197, -34.475636, -4.698298, 1.863880, -33.908211, -17.386549, 1.863880, -29.602753), */
  /* I(-26.675900, 10.766197, -34.475636, -17.386549, 1.863880, -29.602753, -27.166487, 1.863880, -21.020367), */
  /* I(-39.847099, 14.462756, -23.403353, -27.166487, 1.863880, -21.020367, -33.011635, 1.863880, -9.187503), */
  /* I(-44.821884, 12.514625, -0.000000, -39.847099, 14.462756, -23.403353, -33.011635, 1.863880, -9.187503), */
  /* I(-46.226406, 15.263846, -2.995523, -39.847099, 14.462756, -23.403353, -44.821884, 12.514625, -0.000000), */
  /* I(-44.821884, 12.514625, -0.000000, -46.212391, 14.804548, -0.000000, -46.226406, 15.263846, -2.995523), */
  /* I(-47.147533, 18.284660, -5.391940, -39.847099, 14.462756, -23.403353, -46.226406, 15.263846, -2.995523), */
  /* I(-39.847099, 14.462756, -23.403353, -26.675900, 10.766197, -34.475636, -27.166487, 1.863880, -21.020367), */
  /* I(-39.847099, 14.462756, -23.403353, -38.054226, 21.567760, -29.444876, -26.675900, 10.766197, -34.475636), */
  /* I(-28.899599, 16.616825, -37.349522, -26.675900, 10.766197, -34.475636, -38.054226, 21.567760, -29.444876), */
  /* I(-18.719345, 18.983080, -43.996426, -12.035506, 12.514625, -43.244812, -28.899599, 16.616825, -37.349522), */
  /* I(-18.626810, 27.101158, -43.778934, -6.581274, 21.567760, -47.497890, -18.719345, 18.983080, -43.996426), */
  /* I(-6.581274, 21.567760, -47.497890, -6.337523, 32.884182, -45.738712, 6.548908, 18.983082, -47.264248), */
  /* I(-29.155201, 27.101158, -37.679852, -18.626810, 27.101158, -43.778934, -18.719345, 18.983080, -43.996426), */
  /* I(-18.626810, 27.101158, -43.778934, -6.337523, 32.884182, -45.738712, -6.581274, 21.567760, -47.497890), */
  /* I(12.148159, 35.853699, -43.649574, 6.548908, 18.983082, -47.264248, -6.337523, 32.884182, -45.738712), */
  /* I(12.148159, 35.853699, -43.649574, 24.293045, 24.300138, -41.361916, 6.548908, 18.983082, -47.264248), */
  /* I(32.121395, 35.853699, -32.121395, 33.861748, 18.983082, -33.861748, 24.293045, 24.300138, -41.361916), */
  /* I(28.230707, 58.234829, -21.843819, 45.739914, 29.668732, -10.426750, 32.121395, 35.853699, -32.121395), */
  /* I(32.121395, 35.853699, -32.121395, 45.739914, 29.668732, -10.426750, 41.361908, 24.300135, -24.293045), */
  /* I(41.361908, 24.300135, -24.293045, 45.739914, 29.668732, -10.426750, 46.472443, 22.931341, -11.406939), */
  /* I(32.121395, 35.853699, -32.121395, 41.361908, 24.300135, -24.293045, 33.861748, 18.983082, -33.861748), */
  /* I(7.343721, 62.511093, 26.386736, -4.608932, 59.642311, 33.263241, 13.174150, 59.642311, 30.963442), */
  /* I(7.343721, 62.511093, 26.386736, -16.821989, 60.534313, 28.641518, -4.608932, 59.642311, 33.263241), */
  /* I(-4.608932, 59.642311, 33.263241, -16.821989, 60.534313, 28.641518, -20.620541, 59.642315, 26.649752), */
  /* I(-16.821989, 60.534313, 28.641518, -33.263245, 59.642303, 4.608937, -20.620541, 59.642315, 26.649752), */
  /* I(-17.114241, 59.032356, 28.935152, -23.452677, 32.884178, 39.931087, -12.392997, 32.884178, 44.529316), */
  /* I(-25.245144, 58.234821, 25.244675, -23.452677, 32.884178, 39.931087, -17.114241, 59.032356, 28.935152), */
  /* I(-25.245144, 58.234821, 25.244675, -32.121395, 35.853699, 32.121395, -23.452677, 32.884178, 39.931087), */
  /* I(13.955686, 58.234821, 32.800297, -4.882612, 58.234821, 35.236534, 0.000009, 29.964584, 46.898643), */
  /* I(-12.392997, 32.884178, 44.529316, 0.000009, 29.964584, 46.898643, -4.882612, 58.234821, 35.236534), */
  /* I(30.762415, 58.234821, 18.067652, 41.735195, 35.853699, 17.757248, 33.118683, 59.610893, 9.217291), */
  /* I(68.493912, 52.017307, -4.479231, 77.988792, 59.018013, -3.001820, 82.293999, 59.288723, -0.000000), */
  /* I(77.988792, 59.018013, -3.001820, 81.414597, 59.290180, -0.000000, 82.293999, 59.288723, -0.000000), */
  /* I(-46.920513, 17.424940, 5.242165, -47.923016, 21.687986, -0.000000, -53.331390, 24.663134, -0.000000), */
  /* I(-53.331390, 24.663134, -0.000000, -58.978504, 25.694927, 5.391940, -46.920513, 17.424940, 5.242165), */
  /* I(-58.978504, 25.694927, 5.391940, -65.826599, 43.135517, 4.043955, -69.188240, 43.135521, 5.242164), */
  /* I(-69.188240, 43.135521, 5.242164, -67.487587, 33.633667, 4.792836, -58.978504, 25.694927, 5.391940), */
  /* I(-62.943409, 46.252739, -0.000000, -69.188240, 43.135521, 5.242164, -65.826599, 43.135517, 4.043955), */
  /* I(-62.943409, 46.252739, -0.000000, -66.264732, 49.740456, 4.792836, -69.188240, 43.135521, 5.242164), */
  /* I(-66.264732, 49.740456, 4.792836, -62.943409, 46.252739, -0.000000, -38.557339, 51.226913, 5.390856), */
  /* I(-66.264732, 49.740456, 4.792836, -70.756714, 47.634029, 1.647539, -69.188240, 43.135521, 5.242164), */
  /* I(-58.978504, 25.694927, 5.391940, -67.487587, 33.633667, 4.792836, -60.150414, 23.426712, 2.995523), */
  /* I(-69.188240, 43.135521, 5.242164, -71.188026, 37.822628, -0.000000, -67.487587, 33.633667, 4.792836), */
  /* I(-71.188026, 37.822628, -0.000000, -67.331070, 30.270945, -1.647539, -67.487587, 33.633667, 4.792836), */
  /* I(-69.792320, 45.291904, -4.792836, -71.188026, 37.822628, -0.000000, -69.188240, 43.135521, 5.242164), */
  /* I(-69.188240, 43.135521, 5.242164, -70.756714, 47.634029, 1.647539, -69.792320, 45.291904, -4.792836), */
  /* I(-69.792320, 45.291904, -4.792836, -69.400368, 38.397537, -4.792836, -71.188026, 37.822628, -0.000000), */
  /* I(-69.792320, 45.291904, -4.792836, -67.431717, 50.443115, -2.995523, -63.482277, 50.153225, -5.242164), */
  /* I(-69.792320, 45.291904, -4.792836, -70.756714, 47.634029, 1.647539, -67.431717, 50.443115, -2.995523), */
  /* I(-70.756714, 47.634029, 1.647539, -66.264732, 49.740456, 4.792836, -67.431717, 50.443115, -2.995523), */
  /* I(-67.431717, 50.443115, -2.995523, -66.264732, 49.740456, 4.792836, -55.403282, 52.708702, 4.043956), */
  /* I(-55.403282, 52.708702, 4.043956, -38.557339, 51.226913, 5.390856, -37.652912, 53.917545, -0.000000), */
  /* I(-55.403282, 52.708702, 4.043956, -37.652912, 53.917545, -0.000000, -37.995636, 52.520027, -4.792836), */
  /* I(-55.403282, 52.708702, 4.043956, -37.995636, 52.520027, -4.792836, -59.344734, 52.768803, -2.995523), */
  /* I(-67.431717, 50.443115, -2.995523, -55.403282, 52.708702, 4.043956, -59.344734, 52.768803, -2.995523), */
  /* I(2.222010, 68.430176, -3.782721, 3.782721, 68.430176, 2.222010, -3.104417, 68.430191, -3.104417), */
  /* I(-1.174278, 68.430183, 4.218141, -28.802830, 61.941803, -8.016142, 3.782721, 68.430176, 2.222010), */
  /* I(3.782721, 68.430176, 2.222010, 7.343721, 62.511093, 26.386736, -3.104417, 68.430191, -3.104417), */
  /* I(-3.104417, 68.430191, -3.104417, 19.548389, 61.291862, -25.264116, -0.000007, 60.534325, -33.104507), */
  /* I(-1.174278, 68.430183, 4.218141, -3.104417, 68.430191, -3.104417, -0.000007, 60.534325, -33.104507), */
  /* I(-1.174278, 68.430183, 4.218141, -0.000007, 60.534325, -33.104507, -28.802830, 61.941803, -8.016142), */
  /* I(33.104507, 60.534313, -0.000000, -3.104417, 68.430191, -3.104417, 7.343721, 62.511093, 26.386736), */
  /* I(-3.104417, 68.430191, -3.104417, 33.104507, 60.534313, -0.000000, 19.548389, 61.291862, -25.264116), */
  /* I(46.228214, 25.222334, 11.731899, 56.394867, 25.929993, 9.520769, 66.438179, 48.542023, 5.017500), */
  /* I(45.634232, 33.107201, 6.511440, 46.228214, 25.222334, 11.731899, 66.438179, 48.542023, 5.017500), */
  /* I(45.634232, 33.107201, 6.511440, 66.438179, 48.542023, 5.017500, 57.794621, 38.009075, 8.080328), */
  /* I(57.794621, 38.009075, 8.080328, 45.658455, 34.495483, -0.000000, 45.634232, 33.107201, 6.511440), */
  /* I(45.658455, 34.495483, -0.000000, 57.794621, 38.009075, 8.080328, 56.014881, 40.753662, -0.000000), */
  /* I(45.658455, 34.495483, -0.000000, 56.014881, 40.753662, -0.000000, 57.087494, 39.099564, -6.817777), */
  /* I(57.087494, 39.099564, -6.817777, 45.739914, 29.668732, -10.426750, 45.658455, 34.495483, -0.000000), */
  /* I(61.837189, 53.160042, 2.799519, 56.014881, 40.753662, -0.000000, 57.794621, 38.009075, 8.080328), */
  /* I(57.794621, 38.009075, 8.080328, 68.431038, 57.514023, 3.994030, 61.837189, 53.160042, 2.799519), */
  /* I(62.371117, 30.951574, 5.050207, 66.438179, 48.542023, 5.017500, 56.394867, 25.929993, 9.520769), */
  /* I(46.228214, 25.222334, 11.731899, 46.791389, 17.264900, 6.503068, 56.394867, 25.929993, 9.520769), */
  /* I(46.791389, 17.264900, 6.503068, 53.644341, 19.147671, 3.457798, 56.394867, 25.929993, 9.520769), */
  /* I(46.682999, 15.834087, -0.000000, 53.644341, 19.147671, 3.457798, 46.791389, 17.264900, 6.503068), */
  /* I(46.682999, 15.834087, -0.000000, 57.851025, 22.129423, -0.000000, 53.644341, 19.147671, 3.457798), */
  /* I(56.394867, 25.929993, 9.520769, 53.644341, 19.147671, 3.457798, 62.371117, 30.951574, 5.050207), */
  /* I(53.644341, 19.147671, 3.457798, 57.851025, 22.129423, -0.000000, 62.371117, 30.951574, 5.050207), */
  /* I(62.879616, 30.167408, -0.000000, 62.371117, 30.951574, 5.050207, 57.851025, 22.129423, -0.000000), */
  /* I(62.371117, 30.951574, 5.050207, 62.879616, 30.167408, -0.000000, 71.082626, 51.572910, -0.000000), */
  /* I(71.082626, 51.572910, -0.000000, 66.438179, 48.542023, 5.017500, 62.371117, 30.951574, 5.050207), */
  /* I(77.988792, 59.018013, 3.001820, 66.438179, 48.542023, 5.017500, 71.082626, 51.572910, -0.000000), */
  /* I(77.988792, 59.018013, 3.001820, 71.082626, 51.572910, -0.000000, 82.293999, 59.288723, -0.000000), */
  /* I(57.794621, 38.009075, 8.080328, 66.438179, 48.542023, 5.017500, 68.431038, 57.514023, 3.994030), */
  /* I(77.988792, 59.018013, 3.001820, 68.431038, 57.514023, 3.994030, 66.438179, 48.542023, 5.017500), */
  /* I(7.343721, 62.511093, 26.386736, 3.782721, 68.430176, 2.222010, -28.802830, 61.941803, -8.016142), */
  /* I(-16.821989, 60.534313, 28.641518, 7.343721, 62.511093, 26.386736, -28.802830, 61.941803, -8.016142), */
  /* I(33.104507, 60.534313, -0.000000, 7.343721, 62.511093, 26.386736, 30.963442, 59.642311, 13.174147), */
  /* I(-20.659185, 59.032856, 26.552507, -26.634090, 59.032555, 20.547150, -17.114241, 59.032356, 28.935152), */
  /* I(-26.634090, 59.032555, 20.547150, -32.294113, 59.030373, 8.984766, -33.124229, 59.610893, 9.217296), */
  /* I(-32.294113, 59.030373, 8.984766, -33.456272, 59.029667, -0.000000, -33.624737, 59.873005, -0.000000), */
  /* I(-32.294113, 59.030373, 8.984766, -33.624737, 59.873005, -0.000000, -33.124229, 59.610893, 9.217296), */
  /* I(33.118683, 59.610893, 9.217291, 45.658455, 34.495483, -0.000000, 34.304840, 58.234821, -9.547412), */
  /* I(41.735195, 35.853699, 17.757248, 45.634232, 33.107201, 6.511440, 33.118683, 59.610893, 9.217291), */
  /* I(33.118683, 59.610893, 9.217291, 45.634232, 33.107201, 6.511440, 45.658455, 34.495483, -0.000000), */
  /* I(45.739914, 29.668732, -10.426750, 34.304840, 58.234821, -9.547412, 45.658455, 34.495483, -0.000000), */
  /* I(41.735195, 35.853699, 17.757248, 46.228214, 25.222334, 11.731899, 45.634232, 33.107201, 6.511440), */
  /* I(21.591206, 58.824570, 27.904232, 41.735195, 35.853699, 17.757248, 30.762415, 58.234821, 18.067652), */
  /* I(21.591206, 58.824570, 27.904232, 37.679852, 27.101158, 29.155201, 41.735195, 35.853699, 17.757248), */
  /* I(21.591206, 58.824570, 27.904232, 13.955686, 58.234821, 32.800297, 24.293045, 24.300138, 41.361916), */
  /* I(13.955686, 58.234821, 32.800297, 0.000009, 29.964584, 46.898643, 24.293045, 24.300138, 41.361916), */
  /* I(-25.245144, 58.234821, 25.244675, -45.248508, 29.964581, 12.593160, -32.121395, 35.853699, 32.121395), */
  /* I(-25.245144, 58.234821, 25.244675, -33.124229, 59.610893, 9.217296, -45.248508, 29.964581, 12.593160), */
  /* I(-37.652912, 53.917545, -0.000000, -38.557339, 51.226913, 5.390856, -33.624737, 59.873005, -0.000000), */
  /* I(-33.124229, 59.610893, 9.217296, -33.624737, 59.873005, -0.000000, -38.557339, 51.226913, 5.390856), */
  /* I(-38.557339, 51.226913, 5.390856, -40.153595, 48.526070, -0.000000, -46.898643, 29.964584, -0.000000), */
  /* I(-33.124229, 59.610893, 9.217296, -38.557339, 51.226913, 5.390856, -46.898643, 29.964584, -0.000000), */
  /* I(-33.124229, 59.610893, 9.217296, -46.898643, 29.964584, -0.000000, -45.248508, 29.964581, 12.593160), */
  /* I(-45.248508, 29.964581, 12.593160, -46.898643, 29.964584, -0.000000, -46.920513, 17.424940, 5.242165), */
  /* I(-46.898643, 29.964584, -0.000000, -47.923016, 21.687986, -0.000000, -46.920513, 17.424940, 5.242165), */
  /* I(-45.248508, 29.964581, 12.593160, -46.920513, 17.424940, 5.242165, -44.213909, 21.567760, 18.811884), */
  /* I(-44.821884, 12.514625, -0.000000, -46.920513, 17.424940, 5.242165, -46.212391, 14.804548, -0.000000), */
  /* I(-46.920513, 17.424940, 5.242165, -44.821884, 12.514625, -0.000000, -29.602753, 1.863880, 17.386553), */
  /* I(-44.821884, 12.514625, -0.000000, -35.655033, 2.704291, -0.000000, -29.602753, 1.863880, 17.386553), */
  /* I(-35.655033, 2.704291, -0.000000, -34.215515, 1.863880, -0.000000, -29.602753, 1.863880, 17.386553), */
  /* I(0.000007, 1.863880, 34.215515, -13.994600, 2.704291, 32.891766, -21.020367, 1.863880, 27.166487), */
  /* I(-46.920513, 17.424940, 5.242165, -29.602753, 1.863880, 17.386553, -37.349514, 16.616825, 28.899599), */
  /* I(-37.349514, 16.616825, 28.899599, -29.602753, 1.863880, 17.386553, -21.020367, 1.863880, 27.166487), */
  /* I(-46.920513, 17.424940, 5.242165, -37.349514, 16.616825, 28.899599, -44.213909, 21.567760, 18.811884), */
  /* I(-32.121395, 35.853699, 32.121395, -45.248508, 29.964581, 12.593160, -44.213909, 21.567760, 18.811884), */
  /* I(-32.121395, 35.853699, 32.121395, -44.213909, 21.567760, 18.811884, -33.942982, 24.300138, 33.942982), */
  /* I(-44.213909, 21.567760, 18.811884, -37.349514, 16.616825, 28.899599, -33.942982, 24.300138, 33.942982), */
  /* I(-32.121395, 35.853699, 32.121395, -29.300041, 18.983082, 37.867046, -23.452677, 32.884178, 39.931087), */
  /* I(-32.121395, 35.853699, 32.121395, -33.942982, 24.300138, 33.942982, -29.300041, 18.983082, 37.867046), */
  /* I(-33.942982, 24.300138, 33.942982, -37.349514, 16.616825, 28.899599, -29.300041, 18.983082, 37.867046), */
  /* I(-17.592590, 12.514625, 41.348186, -29.300041, 18.983082, 37.867046, -37.349514, 16.616825, 28.899599), */
  /* I(-18.719345, 18.983080, 43.996426, -29.300041, 18.983082, 37.867046, -17.592590, 12.514625, 41.348186), */
  /* I(-17.592590, 12.514625, 41.348186, -37.349514, 16.616825, 28.899599, -21.020367, 1.863880, 27.166487), */
  /* I(-17.592590, 12.514625, 41.348186, -21.020367, 1.863880, 27.166487, -13.994600, 2.704291, 32.891766), */
  /* I(-28.802830, 61.941803, -8.016142, -0.000007, 60.534325, -33.104507, -17.055843, 59.642311, -29.039686), */
  /* I(-16.821989, 60.534313, 28.641518, -28.802830, 61.941803, -8.016142, -33.263245, 59.642303, 4.608937), */
  /* I(59.247063, 35.333176, -8.263747, 45.105232, 31.041933, 8.324440, 45.105232, 31.041933, -8.324440), */
  /* I(59.247063, 35.333176, -8.263747, 49.706287, 34.262356, 3.278664, 45.105232, 31.041933, 8.324440), */
  /* I(57.177288, 39.515884, 4.724274, 45.105232, 31.041933, 8.324440, 49.706287, 34.262356, 3.278664), */
  /* I(55.430447, 27.795492, 9.624819, 45.105232, 31.041933, 8.324440, 57.177288, 39.515884, 4.724274), */
  /* I(45.105232, 31.041933, 8.324440, 55.430447, 27.795492, 9.624819, 45.630348, 25.162910, 11.116575), */
  /* I(57.177288, 39.515884, 4.724274, 69.958687, 58.605934, 2.556232, 55.430447, 27.795492, 9.624819), */
  /* I(57.177288, 39.515884, 4.724274, 49.706287, 34.262356, 3.278664, 55.141747, 37.773933, -2.880229), */
  /* I(49.706287, 34.262356, 3.278664, 59.247063, 35.333176, -8.263747, 55.141747, 37.773933, -2.880229), */
  /* I(57.177288, 39.515884, 4.724274, 55.141747, 37.773933, -2.880229, 62.459641, 52.743523, -2.376829), */
  /* I(62.009407, 52.827225, 1.324532, 69.958687, 58.605934, 2.556232, 57.177288, 39.515884, 4.724274), */
  /* I(55.430447, 27.795492, 9.624819, 69.958687, 58.605934, 2.556232, 70.411682, 52.110897, -0.000000), */
  /* I(62.459641, 52.743523, -2.376829, 62.009407, 52.827225, 1.324532, 57.177288, 39.515884, 4.724274), */
  /* I(-39.429230, 48.989639, 0.000000, -63.967823, 50.115189, 4.153381, -37.757614, 51.428608, 4.720310), */
  /* I(-39.429230, 48.989639, 0.000000, -60.090996, 48.291927, -0.000000, -63.967823, 50.115189, 4.153381), */
  /* I(-60.090996, 48.291927, -0.000000, -68.633446, 46.826305, 4.109865, -63.967823, 50.115189, 4.153381), */
  /* I(-60.090996, 48.291927, -0.000000, -65.562416, 43.174149, 0.000000, -68.633446, 46.826305, 4.109865), */
  /* I(45.105232, 31.041933, -8.324440, 45.630348, 25.162910, -11.116575, 59.247063, 35.333176, -8.263747), */
  /* I(55.141747, 37.773933, -2.880229, 59.247063, 35.333176, -8.263747, 62.459641, 52.743523, -2.376829), */
  /* I(72.977921, 58.735428, -3.352349, 62.459641, 52.743523, -2.376829, 59.247063, 35.333176, -8.263747), */
  /* I(62.459641, 52.743523, -2.376829, 72.977921, 58.735428, -3.352349, 67.887825, 58.525826, -0.000000), */
  /* I(33.118683, 59.610893, 9.217291, 34.304840, 58.234821, -9.547412, 32.279171, 59.029613, -8.985184), */
  /* I(23.754915, 59.029526, -23.754915, 32.279171, 59.029613, -8.985184, 34.304840, 58.234821, -9.547412), */
  /* I(32.279171, 59.029613, -8.985184, 32.279171, 59.029613, 8.985184, 33.118683, 59.610893, 9.217291), */
  /* I(32.279171, 59.029613, 8.985184, 28.946297, 59.029552, 17.002151, 33.118683, 59.610893, 9.217291), */
  /* I(-17.114241, 59.032356, -28.935152, 4.595192, 59.029648, -33.155777, 4.882355, 58.234821, -35.236530), */
  /* I(-4.882612, 58.234821, -35.236534, -17.114241, 59.032356, -28.935152, 4.882355, 58.234821, -35.236530), */
  /* I(-28.995920, 59.031895, -16.997307, -17.114241, 59.032356, -28.935152, -17.478430, 59.610886, -29.698744), */
  /* I(-28.995920, 59.031895, -16.997307, -17.478430, 59.610886, -29.698744, -28.231087, 58.234821, -21.843819), */
  /* I(-47.147533, 18.284660, -5.391940, -53.331390, 24.663134, -0.000000, -47.923016, 21.687986, -0.000000), */
  /* I(-56.810913, 22.241756, -4.792836, -47.147533, 18.284660, -5.391940, -46.226406, 15.263846, -2.995523), */
  /* I(-56.810913, 22.241756, -4.792836, -46.226406, 15.263846, -2.995523, -46.212391, 14.804548, -0.000000), */
  /* I(-56.810913, 22.241756, -4.792836, -69.400368, 38.397537, -4.792836, -65.033691, 44.466053, -2.995522), */
  /* I(-63.482277, 50.153225, -5.242164, -65.033691, 44.466053, -2.995522, -69.400368, 38.397537, -4.792836), */
  /* I(-69.792320, 45.291904, -4.792836, -63.482277, 50.153225, -5.242164, -69.400368, 38.397537, -4.792836), */
  /* I(-67.431717, 50.443115, -2.995523, -37.995636, 52.520027, -4.792836, -63.482277, 50.153225, -5.242164), */
  /* I(-67.431717, 50.443115, -2.995523, -59.344734, 52.768803, -2.995523, -37.995636, 52.520027, -4.792836), */
  /* I(69.958687, 58.605934, 2.556232, 62.009407, 52.827225, 1.324532, 67.887825, 58.525826, -0.000000), */
  /* I(62.009407, 52.827225, 1.324532, 62.459641, 52.743523, -2.376829, 67.887825, 58.525826, -0.000000), */
  /* I(80.842430, 59.272152, -0.000000, 77.988792, 59.018013, 3.001820, 81.414597, 59.290180, -0.000000), */
  /* I(80.842430, 59.272152, -0.000000, 70.411682, 52.110897, -0.000000, 77.988792, 59.018013, 3.001820), */
  /* I(69.958687, 58.605934, 2.556232, 77.988792, 59.018013, 3.001820, 70.411682, 52.110897, -0.000000), */
  /* I(-37.995636, 52.520027, -4.792836, -39.199642, 49.924068, -4.792836, -63.482277, 50.153225, -5.242164), */
  /* I(-40.153595, 48.526070, -0.000000, -62.943409, 46.252739, -0.000000, -39.199642, 49.924068, -4.792836), */
  /* I(-63.482277, 50.153225, -5.242164, -39.199642, 49.924068, -4.792836, -62.943409, 46.252739, -0.000000), */
  /* I(63.504601, 55.494896, -2.576819, 77.988792, 59.018013, -3.001820, 68.493912, 52.017307, -4.479231), */
  /* I(-55.785439, 52.568855, -1.527358, -37.757614, 51.428608, -4.720310, -37.757614, 51.428608, 4.720310), */
  /* I(-55.785439, 52.568855, -1.527358, -67.541267, 48.171173, -4.120241, -37.757614, 51.428608, -4.720310), */
  /* I(-39.429230, 48.989639, 0.000000, -37.757614, 51.428608, -4.720310, -67.541267, 48.171173, -4.120241), */
  /* I(-39.429230, 48.989639, 0.000000, -67.541267, 48.171173, -4.120241, -60.090996, 48.291927, -0.000000), */
  /* I(-66.264732, 49.740456, 4.792836, -38.557339, 51.226913, 5.390856, -55.403282, 52.708702, 4.043956), */
  /* I(-40.153595, 48.526070, -0.000000, -38.557339, 51.226913, 5.390856, -62.943409, 46.252739, -0.000000), */
  /* I(17.796955, 32.651207, -41.812103, 17.002172, 59.029549, -28.946333, 4.595192, 59.029648, -33.155777), */
  /* I(4.595192, 59.029648, -33.155777, -17.114241, 59.032356, -28.935152, -10.629729, 47.753342, -38.169056), */
  /* I(-37.757614, 51.428608, -4.720310, -32.294113, 59.030373, -8.984767, -33.456272, 59.029667, -0.000000), */
  /* I(-37.757614, 51.428608, 4.720310, -33.456272, 59.029667, -0.000000, -32.294113, 59.030373, 8.984766), */
  /* I(-37.757614, 51.428608, -4.720310, -33.456272, 59.029667, -0.000000, -37.757614, 51.428608, 4.720310), */
  /* I(-6.105415, 35.585136, 44.025097, -9.357464, 57.784187, 33.597534, 4.786518, 57.784142, 34.510372), */
  /* I(-46.286690, 17.780519, -4.782351, -60.005768, 29.797796, -0.000000, -60.731197, 28.673861, -4.142333), */
  /* I(-46.286690, 17.780519, -4.782351, -51.192345, 22.269619, 0.000000, -60.005768, 29.797796, -0.000000), */
  /* I(-51.192345, 22.269619, 0.000000, -46.286690, 17.780519, -4.782351, -47.478485, 20.951784, 0.000000), */
  /* I(-60.731197, 28.673861, -4.142333, -69.447159, 38.346462, -3.526338, -46.286690, 17.780519, -4.782351), */
  /* I(-69.447159, 38.346462, -3.526338, -60.731197, 28.673861, -4.142333, -66.952492, 41.298553, -4.100434), */
  /* I(-68.196686, 33.172222, -1.493325, -46.286690, 17.780519, -4.782351, -69.447159, 38.346462, -3.526338), */
  /* I(-46.286690, 17.780519, -4.782351, -68.196686, 33.172222, -1.493325, -59.773224, 23.804155, -1.517380), */
  /* I(-68.196686, 33.172222, -1.493325, -59.462814, 24.431885, 3.591738, -59.773224, 23.804155, -1.517380), */
  /* I(-59.462814, 24.431885, 3.591738, -68.196686, 33.172222, -1.493325, -67.502861, 33.591095, 3.534150), */
  /* I(-35.033134, 13.014719, -27.109894, -18.394096, 19.136747, -43.215271, -33.263454, 19.136986, -33.263454), */
  /* I(-35.033134, 13.014719, -27.109894, -33.263454, 19.136986, -33.263454, -41.788700, 14.872363, -17.786392), */
  /* I(-41.788700, 14.872363, -17.786392, -33.263454, 19.136986, -33.263454, -43.420193, 21.587780, -18.481409), */
  /* I(-41.788700, 14.872363, -17.786392, -43.420193, 21.587780, -18.481409, -46.286690, 17.780519, -4.782351), */
  /* I(-43.215271, 19.136749, 18.394100, -45.814693, 16.412136, 3.809999, -46.539436, 18.485825, 4.818050), */
  /* I(-46.539436, 18.485825, 4.818050, -47.478485, 20.951784, 0.000000, -44.438335, 29.775816, 12.375013), */
  /* I(-44.438335, 29.775816, 12.375013, -37.757614, 51.428608, 4.720310, -40.981113, 35.584644, 17.443298), */
  /* I(-47.478485, 20.951784, 0.000000, -37.757614, 51.428608, 4.720310, -44.438335, 29.775816, 12.375013), */
  /* I(-37.757614, 51.428608, 4.720310, -32.294113, 59.030373, 8.984766, -40.981113, 35.584644, 17.443298), */
  /* I(-39.429230, 48.989639, 0.000000, -37.757614, 51.428608, 4.720310, -37.757614, 51.428608, -4.720310), */
  /* I(-41.812103, 32.651207, -17.796955, -32.183491, 32.650860, -32.183491, -28.995920, 59.031895, -16.997307), */
  /* I(-37.757614, 51.428608, -4.720310, -41.812103, 32.651207, -17.796955, -28.995920, 59.031895, -16.997307), */
  /* I(-37.757614, 51.428608, 4.720310, -46.188663, 26.965590, -6.405409, -37.757614, 51.428608, -4.720310), */
  /* I(-47.478485, 20.951784, 0.000000, -46.188663, 26.965590, -6.405409, -37.757614, 51.428608, 4.720310), */
  /* I(-46.188663, 26.965590, -6.405409, -41.812103, 32.651207, -17.796955, -37.757614, 51.428608, -4.720310), */
  /* I(-47.478485, 20.951784, 0.000000, -46.286690, 17.780519, -4.782351, -46.188663, 26.965590, -6.405409), */
  /* I(-46.286690, 17.780519, -4.782351, -43.420193, 21.587780, -18.481409, -46.188663, 26.965590, -6.405409), */
  /* I(-43.420193, 21.587780, -18.481409, -41.812103, 32.651207, -17.796955, -46.188663, 26.965590, -6.405409), */
  /* I(-43.420193, 21.587780, -18.481409, -33.263454, 19.136986, -33.263454, -32.183491, 32.650860, -32.183491), */
  /* I(-18.394096, 19.136747, -43.215271, -23.037514, 32.651020, -39.214935, -33.263454, 19.136986, -33.263454), */
  /* I(-23.037514, 32.651020, -39.214935, -32.183491, 32.650860, -32.183491, -33.263454, 19.136986, -33.263454), */
  /* I(-43.420193, 21.587780, -18.481409, -32.183491, 32.650860, -32.183491, -41.812103, 32.651207, -17.796955), */
  /* I(-6.229186, 32.651646, -44.917866, -10.629729, 47.753342, -38.169056, -23.037514, 32.651020, -39.214935), */
  /* I(0.000009, 26.965652, -46.607578, -10.629729, 47.753342, -38.169056, -6.229186, 32.651646, -44.917866), */
  /* I(-18.394096, 19.136747, -43.215271, -6.229186, 32.651646, -44.917866, -23.037514, 32.651020, -39.214935), */
  /* I(-6.438161, 19.136450, -46.425316, -6.229186, 32.651646, -44.917866, -18.394096, 19.136747, -43.215271), */
  /* I(0.000009, 26.965652, -46.607578, -6.229186, 32.651646, -44.917866, -6.438161, 19.136450, -46.425316), */
  /* I(-6.438161, 19.136450, -46.425316, 12.586329, 19.136593, -45.197449, 0.000009, 26.965652, -46.607578), */
  /* I(0.000009, 26.965652, -46.607578, 12.586329, 19.136593, -45.197449, 17.796955, 32.651207, -41.812103), */
  /* I(12.586329, 19.136593, -45.197449, 28.920742, 21.587809, -37.372696, 17.796955, 32.651207, -41.812103), */
  /* I(35.968498, 14.872812, -27.833845, 46.149780, 17.777922, -6.248612, 45.630348, 25.162910, -11.116575), */
  /* I(35.968498, 14.872812, -27.833845, 45.630348, 25.162910, -11.116575, 40.324284, 26.965208, -23.689205), */
  /* I(45.630348, 25.162910, -11.116575, 45.105232, 31.041933, -8.324440, 40.324284, 26.965208, -23.689205), */
  /* I(28.920742, 21.587809, -37.372696, 35.968498, 14.872812, -27.833845, 40.324284, 26.965208, -23.689205), */
  /* I(28.920742, 21.587809, -37.372696, 27.849709, 32.650898, -35.988647, 17.796955, 32.651207, -41.812103), */
  /* I(40.324284, 26.965208, -23.689205, 27.849709, 32.650898, -35.988647, 28.920742, 21.587809, -37.372696), */
  /* I(40.324284, 26.965208, -23.689205, 30.129244, 57.783195, -17.700596, 27.849709, 32.650898, -35.988647), */
  /* I(34.823338, 57.784286, -0.000000, 30.129244, 57.783195, -17.700596, 40.324284, 26.965208, -23.689205), */
  /* I(45.105232, 31.041933, -8.324440, 34.823338, 57.784286, -0.000000, 40.324284, 26.965208, -23.689205), */
  /* I(45.105232, 31.041933, 8.324440, 34.823338, 57.784286, -0.000000, 45.105232, 31.041933, -8.324440), */
  /* I(34.823338, 57.784286, -0.000000, 45.105232, 31.041933, 8.324440, 32.279171, 59.029613, 8.985184), */
  /* I(45.105232, 31.041933, 8.324440, 28.946297, 59.029552, 17.002151, 32.279171, 59.029613, 8.985184), */
  /* I(77.988792, 59.018013, -3.001820, 80.842430, 59.272152, -0.000000, 81.414597, 59.290180, -0.000000), */
  /* I(80.842430, 59.272152, -0.000000, 77.988792, 59.018013, -3.001820, 70.411682, 52.110897, -0.000000), */
  /* I(26.649752, 59.642311, -20.620539, 0.000005, 66.220215, 4.175292, 13.174147, 59.642311, -30.963442), */
  /* I(33.263245, 59.642303, -4.608937, 0.000005, 66.220215, 4.175292, 26.649752, 59.642311, -20.620539), */
  /* I(-26.649752, 59.642315, -20.620541, -17.055843, 59.642311, -29.039686, -33.263245, 59.642303, 4.608937), */
  /* I(-33.263245, 59.642303, 4.608937, -4.608932, 59.642311, 33.263241, -20.620541, 59.642315, 26.649752), */
  /* I(-17.055843, 59.642311, -29.039686, 0.000005, 66.220215, 4.175292, -33.263245, 59.642303, 4.608937), */
  /* I(-33.263245, 59.642303, 4.608937, 0.000005, 66.220215, 4.175292, -4.608932, 59.642311, 33.263241), */
  /* I(-4.608932, 59.642311, 33.263241, 0.000005, 66.220215, 4.175292, 13.174150, 59.642311, 30.963442), */
  /* I(13.174150, 59.642311, 30.963442, 0.000005, 66.220215, 4.175292, 30.963442, 59.642311, 13.174147), */
  /* I(0.000005, 66.220215, 4.175292, -17.055843, 59.642311, -29.039686, 13.174147, 59.642311, -30.963442), */
  /* I(33.263245, 59.642303, -4.608937, 30.963442, 59.642311, 13.174147, 0.000005, 66.220215, 4.175292), */
  /* I(-60.005768, 29.797796, -0.000000, -46.539436, 18.485825, 4.818050, -59.462814, 24.431885, 3.591738), */
  /* I(-45.814693, 16.412136, 3.809999, -59.462814, 24.431885, 3.591738, -46.539436, 18.485825, 4.818050), */
  /* I(-46.286690, 17.780519, -4.782351, -59.462814, 24.431885, 3.591738, -45.814693, 16.412136, 3.809999), */
  /* I(-59.462814, 24.431885, 3.591738, -46.286690, 17.780519, -4.782351, -59.773224, 23.804155, -1.517380), */
  /* I(-67.502861, 33.591095, 3.534150, -68.633446, 46.826305, 4.109865, -59.462814, 24.431885, 3.591738), */
  /* I(0.000009, 26.965652, -46.607578, 17.796955, 32.651207, -41.812103, 4.595192, 59.029648, -33.155777), */
  /* I(0.000009, 26.965652, -46.607578, 4.595192, 59.029648, -33.155777, -10.629729, 47.753342, -38.169056), */
  /* I(-10.629729, 47.753342, -38.169056, -17.114241, 59.032356, -28.935152, -23.037514, 32.651020, -39.214935), */
  /* I(-23.037514, 32.651020, -39.214935, -17.114241, 59.032356, -28.935152, -32.183491, 32.650860, -32.183491), */
  /* I(-32.183491, 32.650860, -32.183491, -17.114241, 59.032356, -28.935152, -28.995920, 59.031895, -16.997307), */
  /* I(-37.757614, 51.428608, -4.720310, -28.995920, 59.031895, -16.997307, -32.294113, 59.030373, -8.984767), */
  /* I(-40.981113, 35.584644, 17.443298, -32.294113, 59.030373, 8.984766, -26.634090, 59.032555, 20.547150), */
  /* I(-40.981113, 35.584644, 17.443298, -26.634090, 59.032555, 20.547150, -32.183491, 32.650860, 32.183491), */
  /* I(-20.737501, 59.004364, 26.714230, -32.183491, 32.650860, 32.183491, -26.634090, 59.032555, 20.547150), */
  /* I(-9.357464, 57.784187, 33.597534, -32.183491, 32.650860, 32.183491, -20.737501, 59.004364, 26.714230), */
  /* I(-18.085241, 29.775631, 42.489464, -32.183491, 32.650860, 32.183491, -9.357464, 57.784187, 33.597534), */
  /* I(-6.105415, 35.585136, 44.025097, -18.085241, 29.775631, 42.489464, -9.357464, 57.784187, 33.597534), */
  /* I(-44.438335, 29.775816, 12.375013, -40.981113, 35.584644, 17.443298, -37.278599, 24.227501, 28.847925), */
  /* I(-37.278599, 24.227501, 28.847925, -40.981113, 35.584644, 17.443298, -32.183491, 32.650860, 32.183491), */
  /* I(6.438169, 19.136452, 46.425312, -6.105415, 35.585136, 44.025097, 17.796955, 32.651207, 41.812103), */
  /* I(6.438169, 19.136452, 46.425312, -6.438161, 19.136450, 46.425316, -6.105415, 35.585136, 44.025097), */
  /* I(-6.438161, 19.136450, 46.425316, -18.152813, 16.910444, 42.648907, -6.105415, 35.585136, 44.025097), */
  /* I(-18.152813, 16.910444, 42.648907, -18.085241, 29.775631, 42.489464, -6.105415, 35.585136, 44.025097), */
  /* I(-18.152813, 16.910444, 42.648907, -28.784225, 19.136959, 37.196335, -18.085241, 29.775631, 42.489464), */
  /* I(-28.784225, 19.136959, 37.196335, -32.183491, 32.650860, 32.183491, -18.085241, 29.775631, 42.489464), */
  /* I(-28.784225, 19.136959, 37.196335, -37.278599, 24.227501, 28.847925, -32.183491, 32.650860, 32.183491), */
  /* I(-35.968491, 14.872812, 27.833845, -43.215271, 19.136749, 18.394100, -37.278599, 24.227501, 28.847925), */
  /* I(-43.215271, 19.136749, 18.394100, -44.438335, 29.775816, 12.375013, -37.278599, 24.227501, 28.847925), */
  /* I(-46.539436, 18.485825, 4.818050, -44.438335, 29.775816, 12.375013, -43.215271, 19.136749, 18.394100), */
  /* I(-35.968491, 14.872812, 27.833845, -37.278599, 24.227501, 28.847925, -28.784225, 19.136959, 37.196335), */
  /* I(-35.968491, 14.872812, 27.833845, -28.784225, 19.136959, 37.196335, -21.739914, 11.332741, 37.007614), */
  /* I(-21.739914, 11.332741, 37.007614, -28.784225, 19.136959, 37.196335, -18.152813, 16.910444, 42.648907), */
  /* I(-21.498280, 3.247481, 27.780914, -35.968491, 14.872812, 27.833845, -21.739914, 11.332741, 37.007614), */
  /* I(-21.498280, 3.247481, 27.780914, -33.756077, 3.246699, 9.400525, -35.968491, 14.872812, 27.833845), */
  /* I(-35.968491, 14.872812, 27.833845, -45.814693, 16.412136, 3.809999, -43.215271, 19.136749, 18.394100), */
  /* I(-33.756077, 3.246699, 9.400525, -45.814693, 16.412136, 3.809999, -35.968491, 14.872812, 27.833845), */
  /* I(-21.498280, 3.247481, 27.780914, -21.739914, 11.332741, 37.007614, -4.808609, 3.246404, 34.672924), */
  /* I(-21.498280, 3.247481, 27.780914, -27.712137, 1.662043, 3.840329, -33.756077, 3.246699, 9.400525), */
  /* I(-3.604242, 75.812813, -8.452425, 2.222010, 68.430176, -3.782721, -3.104417, 68.430191, -3.104417), */
  /* I(-1.174278, 68.430183, 4.218141, -9.287612, 76.854958, 1.291646, -3.104417, 68.430191, -3.104417), */
  /* I(-62.943409, 46.252739, -0.000000, -65.033691, 44.466053, -2.995522, -63.482277, 50.153225, -5.242164), */
  /* I(-62.943409, 46.252739, -0.000000, -63.016899, 36.345665, -0.000000, -65.033691, 44.466053, -2.995522), */
  /* I(-3.687933, 76.854973, 8.648291, -1.174278, 68.430183, 4.218141, 8.648290, 76.854973, 3.687933), */
  /* I(8.113047, 76.854965, -4.772230, 8.648290, 76.854973, 3.687933, 3.782721, 68.430176, 2.222010), */
  /* I(1.291645, 76.854980, -9.287611, 8.113047, 76.854965, -4.772230, 2.222010, 68.430176, -3.782721), */
  /* I(-3.604242, 75.812813, -8.452425, 1.291645, 76.854980, -9.287611, 2.222010, 68.430176, -3.782721), */
  /* I(-7.929260, 75.812790, -4.663979, -3.604242, 75.812813, -8.452425, -3.104417, 68.430191, -3.104417), */
  /* I(-9.287612, 76.854958, 1.291646, -7.929260, 75.812790, -4.663979, -3.104417, 68.430191, -3.104417), */
  /* I(-3.687933, 76.854973, 8.648291, -9.287612, 76.854958, 1.291646, -1.174278, 68.430183, 4.218141), */
  /* I(8.648290, 76.854973, 3.687933, -1.174278, 68.430183, 4.218141, 3.782721, 68.430176, 2.222010), */
  /* I(2.222010, 68.430176, -3.782721, 8.113047, 76.854965, -4.772230, 3.782721, 68.430176, 2.222010), */
  /* I(-20.659185, 59.032856, 26.552507, -20.737501, 59.004364, 26.714230, -26.634090, 59.032555, 20.547150), */
  /* I(-17.114241, 59.032356, 28.935152, -20.737501, 59.004364, 26.714230, -20.659185, 59.032856, 26.552507), */
  /* I(-6.105415, 35.585136, 44.025097, 4.786518, 57.784142, 34.510372, 17.796955, 32.651207, 41.812103), */
  /* I(17.796955, 32.651207, 41.812103, 4.786518, 57.784142, 34.510372, 17.002172, 59.029549, 28.946333), */
  /* I(-4.651231, 59.029964, 33.154255, -9.357464, 57.784187, 33.597534, -17.114241, 59.032356, 28.935152), */
  /* I(-9.357464, 57.784187, 33.597534, -20.737501, 59.004364, 26.714230, -17.114241, 59.032356, 28.935152), */
  /* I(4.786518, 57.784142, 34.510372, -9.357464, 57.784187, 33.597534, -4.651231, 59.029964, 33.154255), */
  /* I(4.786518, 57.784142, 34.510372, -4.651231, 59.029964, 33.154255, 17.002172, 59.029549, 28.946333), */
  /* I(34.823338, 57.784286, -0.000000, 32.279171, 59.029613, 8.985184, 32.279171, 59.029613, -8.985184), */
  /* I(32.279171, 59.029613, -8.985184, 23.754915, 59.029526, -23.754915, 30.129244, 57.783195, -17.700596), */
  /* I(34.823338, 57.784286, -0.000000, 32.279171, 59.029613, -8.985184, 30.129244, 57.783195, -17.700596), */
  /* I(-27.712137, 1.662043, 3.840329, -21.498280, 3.247481, 27.780914, 17.826597, 3.404658, 30.342834), */
  /* I(-30.271255, 3.247304, -17.783575, -33.756077, 3.246699, 9.400525, -27.712137, 1.662043, 3.840329), */
  /* I(11.853461, 13.013903, 42.568661, 6.438169, 19.136452, 46.425312, 18.394100, 19.136749, 43.215271), */
  /* I(4.808615, 3.246402, 34.672913, -4.808609, 3.246404, 34.672924, 11.853461, 13.013903, 42.568661), */
  /* I(6.438169, 19.136452, 46.425312, 17.796955, 32.651207, 41.812103, 18.394100, 19.136749, 43.215271), */
  /* I(33.756081, 3.246700, 9.400521, 46.075687, 16.442997, 0.000000, 34.672924, 3.246404, -4.808609), */
  /* I(30.271254, 3.247304, -17.783573, 34.672924, 3.246404, -4.808609, 35.968498, 14.872812, -27.833845), */
  /* I(35.968498, 14.872812, -27.833845, 34.672924, 3.246404, -4.808609, 46.149780, 17.777922, -6.248612), */
  /* I(30.271254, 3.247304, -17.783573, 35.968498, 14.872812, -27.833845, 21.498280, 3.247482, -27.780914), */
  /* I(35.968498, 14.872812, -27.833845, 17.323555, 13.014250, -40.701973, 21.498280, 3.247482, -27.780914), */
  /* I(35.968498, 14.872812, -27.833845, 28.920742, 21.587809, -37.372696, 17.323555, 13.014250, -40.701973), */
  /* I(17.323555, 13.014250, -40.701973, 12.586329, 19.136593, -45.197449, -6.438161, 19.136450, -46.425316), */
  /* I(17.323555, 13.014250, -40.701973, 28.920742, 21.587809, -37.372696, 12.586329, 19.136593, -45.197449), */
  /* I(-27.712137, 1.662043, 3.840329, 21.498280, 3.247482, -27.780914, -9.400521, 3.246700, -33.756081), */
  /* I(-27.712137, 1.662043, 3.840329, 33.756081, 3.246700, 9.400521, 21.498280, 3.247482, -27.780914), */
  /* I(17.826597, 3.404658, 30.342834, -21.498280, 3.247481, 27.780914, 4.808615, 3.246402, 34.672913), */
  /* I(-21.498280, 3.247481, 27.780914, -4.808609, 3.246404, 34.672924, 4.808615, 3.246402, 34.672913), */
  /* I(56.014881, 40.753662, -0.000000, 61.837189, 53.160042, 2.799519, 63.504601, 55.494896, -2.576819), */
  /* I(56.014881, 40.753662, -0.000000, 63.504601, 55.494896, -2.576819, 57.087494, 39.099564, -6.817777), */
  /* I(63.504601, 55.494896, -2.576819, 61.837189, 53.160042, 2.799519, 68.431038, 57.514023, 3.994030), */
  /* I(63.504601, 55.494896, -2.576819, 68.431038, 57.514023, 3.994030, 67.887825, 58.525826, -0.000000), */
  /* I(81.414597, 59.290180, -0.000000, 77.988792, 59.018013, 3.001820, 82.293999, 59.288723, -0.000000), */
  /* I(77.988792, 59.018013, 3.001820, 69.958687, 58.605934, 2.556232, 68.431038, 57.514023, 3.994030), */
  /* I(67.887825, 58.525826, -0.000000, 68.431038, 57.514023, 3.994030, 69.958687, 58.605934, 2.556232), */
  /* I(72.977921, 58.735428, -3.352349, 77.988792, 59.018013, -3.001820, 67.887825, 58.525826, -0.000000), */
  /* I(63.504601, 55.494896, -2.576819, 67.887825, 58.525826, -0.000000, 77.988792, 59.018013, -3.001820), */
  /* I(17.826597, 3.404658, 30.342834, 33.756081, 3.246700, 9.400521, -27.712137, 1.662043, 3.840329), */
  /* I(27.849709, 32.650898, -35.988647, 23.754915, 59.029526, -23.754915, 17.002172, 59.029549, -28.946333), */
  /* I(17.796955, 32.651207, -41.812103, 27.849709, 32.650898, -35.988647, 17.002172, 59.029549, -28.946333), */
  /* I(27.849709, 32.650898, -35.988647, 30.129244, 57.783195, -17.700596, 23.754915, 59.029526, -23.754915), */
  /* I(0.000007, 3.246296, -34.987328, 21.498280, 3.247482, -27.780914, -9.400521, 3.246700, -33.756081), */
  /* I(-9.400521, 3.246700, -33.756081, 21.498280, 3.247482, -27.780914, 0.000007, 3.246296, -34.987328), */
  /* I(-30.271255, 3.247304, -17.783575, -27.712137, 1.662043, 3.840329, -9.400521, 3.246700, -33.756081), */
  /* I(17.002172, 59.029549, 28.946333, 28.946297, 59.029552, 17.002151, 31.543901, 35.584255, 31.543900), */
  /* I(39.850201, 29.775475, 23.410694, 31.543901, 35.584255, 31.543900, 28.946297, 59.029552, 17.002151), */
  /* I(45.105232, 31.041933, 8.324440, 39.850201, 29.775475, 23.410694, 28.946297, 59.029552, 17.002151), */
  /* I(45.630348, 25.162910, 11.116575, 39.850201, 29.775475, 23.410694, 45.105232, 31.041933, 8.324440), */
  /* I(45.630348, 25.162910, 11.116575, 40.723083, 21.587797, 23.923494, 39.850201, 29.775475, 23.410694), */
  /* I(40.723083, 21.587797, 23.923494, 45.630348, 25.162910, 11.116575, 46.149780, 17.777922, 6.248612), */
  /* I(33.756081, 3.246700, 9.400521, 40.723083, 21.587797, 23.923494, 46.149780, 17.777922, 6.248612), */
  /* I(35.033138, 13.014720, 27.109894, 40.723083, 21.587797, 23.923494, 33.756081, 3.246700, 9.400521), */
  /* I(33.756081, 3.246700, 9.400521, 46.149780, 17.777922, 6.248612, 46.075687, 16.442997, 0.000000), */
  /* I(34.672924, 3.246404, -4.808609, 46.075687, 16.442997, 0.000000, 46.149780, 17.777922, -6.248612), */
  /* I(17.826597, 3.404658, 30.342834, 35.033138, 13.014720, 27.109894, 33.756081, 3.246700, 9.400521), */
  /* I(17.826597, 3.404658, 30.342834, 27.833845, 14.872812, 35.968491, 35.033138, 13.014720, 27.109894), */
  /* I(33.756081, 3.246700, 9.400521, 34.672924, 3.246404, -4.808609, 30.271254, 3.247304, -17.783573), */
  /* I(21.498280, 3.247482, -27.780914, 33.756081, 3.246700, 9.400521, 30.271254, 3.247304, -17.783573), */
  /* I(21.498280, 3.247482, -27.780914, -6.063061, 13.013579, -43.724884, -9.400521, 3.246700, -33.756081), */
  /* I(-30.271255, 3.247304, -17.783575, -9.400521, 3.246700, -33.756081, -17.323549, 13.014250, -40.701973), */
  /* I(-30.271255, 3.247304, -17.783575, -17.323549, 13.014250, -40.701973, -35.033134, 13.014719, -27.109894), */
  /* I(-30.271255, 3.247304, -17.783575, -35.033134, 13.014719, -27.109894, -41.788700, 14.872363, -17.786392), */
  /* I(-35.033134, 13.014719, -27.109894, -17.323549, 13.014250, -40.701973, -18.394096, 19.136747, -43.215271), */
  /* I(-17.323549, 13.014250, -40.701973, -6.063061, 13.013579, -43.724884, -18.394096, 19.136747, -43.215271), */
  /* I(-9.400521, 3.246700, -33.756081, -6.063061, 13.013579, -43.724884, -17.323549, 13.014250, -40.701973), */
  /* I(-6.063061, 13.013579, -43.724884, -6.438161, 19.136450, -46.425316, -18.394096, 19.136747, -43.215271), */
  /* I(21.498280, 3.247482, -27.780914, 17.323555, 13.014250, -40.701973, -6.063061, 13.013579, -43.724884), */
  /* I(17.323555, 13.014250, -40.701973, -6.438161, 19.136450, -46.425316, -6.063061, 13.013579, -43.724884), */
  /* I(17.826597, 3.404658, 30.342834, 4.808615, 3.246402, 34.672913, 11.853461, 13.013903, 42.568661), */
  /* I(17.826597, 3.404658, 30.342834, 11.853461, 13.013903, 42.568661, 27.833845, 14.872812, 35.968491), */
  /* I(27.833845, 14.872812, 35.968491, 11.853461, 13.013903, 42.568661, 18.394100, 19.136749, 43.215271), */
  /* I(35.033138, 13.014720, 27.109894, 27.833845, 14.872812, 35.968491, 33.263454, 19.136986, 33.263454), */
  /* I(35.033138, 13.014720, 27.109894, 33.263454, 19.136986, 33.263454, 40.723083, 21.587797, 23.923494), */
  /* I(27.833845, 14.872812, 35.968491, 18.394100, 19.136749, 43.215271, 28.920742, 21.587809, 37.372696), */
  /* I(33.263454, 19.136986, 33.263454, 27.833845, 14.872812, 35.968491, 28.920742, 21.587809, 37.372696), */
  /* I(40.723083, 21.587797, 23.923494, 33.263454, 19.136986, 33.263454, 39.850201, 29.775475, 23.410694), */
  /* I(28.920742, 21.587809, 37.372696, 39.850201, 29.775475, 23.410694, 33.263454, 19.136986, 33.263454), */
  /* I(28.920742, 21.587809, 37.372696, 31.543901, 35.584255, 31.543900, 39.850201, 29.775475, 23.410694), */
  /* I(17.796955, 32.651207, 41.812103, 17.002172, 59.029549, 28.946333, 31.543901, 35.584255, 31.543900), */
  /* I(28.920742, 21.587809, 37.372696, 17.796955, 32.651207, 41.812103, 31.543901, 35.584255, 31.543900), */
  /* I(18.394100, 19.136749, 43.215271, 17.796955, 32.651207, 41.812103, 28.920742, 21.587809, 37.372696), */
  /* I(59.247063, 35.333176, -8.263747, 59.631214, 27.306948, -5.226165, 70.411682, 52.110897, -0.000000), */
  /* I(59.631214, 27.306948, -5.226165, 57.238297, 22.732883, -0.000000, 70.411682, 52.110897, -0.000000), */
  /* I(55.961720, 26.256136, -8.853226, 59.631214, 27.306948, -5.226165, 59.247063, 35.333176, -8.263747), */
  /* I(57.238297, 22.732883, -0.000000, 46.149780, 17.777922, -6.248612, 46.075687, 16.442997, 0.000000), */
  /* I(55.961720, 26.256136, -8.853226, 57.238297, 22.732883, -0.000000, 59.631214, 27.306948, -5.226165), */
  /* I(55.961720, 26.256136, -8.853226, 46.149780, 17.777922, -6.248612, 57.238297, 22.732883, -0.000000), */
  /* I(55.961720, 26.256136, -8.853226, 45.630348, 25.162910, -11.116575, 46.149780, 17.777922, -6.248612), */
  /* I(55.961720, 26.256136, -8.853226, 59.247063, 35.333176, -8.263747, 45.630348, 25.162910, -11.116575), */
  /* I(59.247063, 35.333176, -8.263747, 70.411682, 52.110897, -0.000000, 72.977921, 58.735428, -3.352349), */
  /* I(77.988792, 59.018013, -3.001820, 72.977921, 58.735428, -3.352349, 70.411682, 52.110897, -0.000000), */
  /* I(-30.271255, 3.247304, -17.783575, -46.286690, 17.780519, -4.782351, -45.814693, 16.412136, 3.809999), */
  /* I(-41.788700, 14.872363, -17.786392, -46.286690, 17.780519, -4.782351, -30.271255, 3.247304, -17.783575), */
  /* I(-30.271255, 3.247304, -17.783575, -45.814693, 16.412136, 3.809999, -33.756077, 3.246699, 9.400525), */
  /* I(-56.810913, 22.241756, -4.792836, -65.033691, 44.466053, -2.995522, -63.016899, 36.345665, -0.000000), */
  /* I(-53.331390, 24.663134, -0.000000, -47.147533, 18.284660, -5.391940, -63.016899, 36.345665, -0.000000), */
  /* I(-63.016899, 36.345665, -0.000000, -47.147533, 18.284660, -5.391940, -56.810913, 22.241756, -4.792836), */
  /* I(-21.739914, 11.332741, 37.007614, 0.000009, 14.871587, 45.299545, -4.808609, 3.246404, 34.672924), */
  /* I(11.853461, 13.013903, 42.568661, -4.808609, 3.246404, 34.672924, 0.000009, 14.871587, 45.299545), */
  /* I(-21.739914, 11.332741, 37.007614, -18.152813, 16.910444, 42.648907, 0.000009, 14.871587, 45.299545), */
  /* I(-18.152813, 16.910444, 42.648907, -6.438161, 19.136450, 46.425316, 0.000009, 14.871587, 45.299545), */
  /* I(-6.438161, 19.136450, 46.425316, 6.438169, 19.136452, 46.425312, 0.000009, 14.871587, 45.299545), */
  /* I(11.853461, 13.013903, 42.568661, 0.000009, 14.871587, 45.299545, 6.438169, 19.136452, 46.425312), */
  /* I(70.411682, 52.110897, -0.000000, 61.110249, 32.051811, 6.369339, 55.430447, 27.795492, 9.624819), */
  /* I(61.110249, 32.051811, 6.369339, 70.411682, 52.110897, -0.000000, 57.238297, 22.732883, -0.000000), */
  /* I(61.110249, 32.051811, 6.369339, 52.679657, 21.972109, 7.949081, 55.430447, 27.795492, 9.624819), */
  /* I(57.238297, 22.732883, -0.000000, 52.679657, 21.972109, 7.949081, 61.110249, 32.051811, 6.369339), */
  /* I(52.679657, 21.972109, 7.949081, 45.630348, 25.162910, 11.116575, 55.430447, 27.795492, 9.624819), */
  /* I(52.679657, 21.972109, 7.949081, 46.149780, 17.777922, 6.248612, 45.630348, 25.162910, 11.116575), */
  /* I(52.679657, 21.972109, 7.949081, 57.238297, 22.732883, -0.000000, 46.149780, 17.777922, 6.248612), */
  /* I(57.238297, 22.732883, -0.000000, 46.075687, 16.442997, 0.000000, 46.149780, 17.777922, 6.248612), */
  /* I(-62.943409, 46.252739, -0.000000, -65.826599, 43.135517, 4.043955, -63.016899, 36.345665, -0.000000), */
  /* I(-63.016899, 36.345665, -0.000000, -65.826599, 43.135517, 4.043955, -58.978504, 25.694927, 5.391940), */
  /* I(-63.016899, 36.345665, -0.000000, -58.978504, 25.694927, 5.391940, -53.331390, 24.663134, -0.000000), */
  /* I(-68.196686, 33.172222, -1.493325, -70.804443, 45.421791, -0.000000, -67.502861, 33.591095, 3.534150), */
  /* I(-67.502861, 33.591095, 3.534150, -70.804443, 45.421791, -0.000000, -68.633446, 46.826305, 4.109865), */
  /* I(-70.804443, 45.421791, -0.000000, -67.541267, 48.171173, -4.120241, -68.633446, 46.826305, 4.109865), */
  /* I(-68.633446, 46.826305, 4.109865, -67.541267, 48.171173, -4.120241, -63.967823, 50.115189, 4.153381), */
  /* I(-37.757614, 51.428608, 4.720310, -63.967823, 50.115189, 4.153381, -55.785439, 52.568855, -1.527358), */
  /* I(-55.785439, 52.568855, -1.527358, -63.967823, 50.115189, 4.153381, -67.541267, 48.171173, -4.120241), */
  /* I(-68.196686, 33.172222, -1.493325, -69.447159, 38.346462, -3.526338, -70.804443, 45.421791, -0.000000), */
  /* I(-69.447159, 38.346462, -3.526338, -67.541267, 48.171173, -4.120241, -70.804443, 45.421791, -0.000000), */
  /* I(-69.447159, 38.346462, -3.526338, -66.952492, 41.298553, -4.100434, -67.541267, 48.171173, -4.120241), */
};

#undef I

////////////////////////////////////////////////////////////////////////////////
bool SceneRaycast(glm::vec3 ori, glm::vec3 dir, float & dist, glm::vec2 & uv) {
  dist = std::numeric_limits<float>::max();
  bool hasIntersection = false;

  for (auto & tri : triangles) {
    float triDistance; glm::vec2 triUv;
    bool intersects =
      RayTriangleIntersection(ori, dir, tri, triDistance, triUv);
    if (intersects && triDistance < dist) {
      dist = triDistance;
      uv = triUv;
      hasIntersection = true;
    }
  }

  return hasIntersection;
}

////////////////////////////////////////////////////////////////////////////////
glm::vec3 Render(glm::vec2 const uv) {
  glm::vec3 eyeOri, eyeDir;
  eyeOri = glm::vec3(5.0f, 5.0f, 5.0f);
  eyeDir = LookAt(eyeOri, uv);

  float triDistance; glm::vec2 triUv;
  bool intersects = SceneRaycast(eyeOri, eyeDir, triDistance, triUv);

  if (!intersects) { return glm::vec3(uv, 0.5f); }

  return glm::vec3(triUv, 0.5f);
}

////////////////////////////////////////////////////////////////////////////////
int main(int argc, char** argv) {

  auto buffer = Buffer::Construct(640, 480);

  spdlog::info(
    "Rendering at resolution ({}, {})",
    buffer.Width(), buffer.Height()
  );

  float const aspectRatio = buffer.Width()/static_cast<float>(buffer.Height());
  for (size_t i = 0u; i < buffer.Width()*buffer.Height(); ++ i) {
    size_t x = i%buffer.Width(), y = i/buffer.Width();
    buffer.At(i) = Render(glm::vec2(x, y * aspectRatio) / buffer.Dim());
  }

  SaveImage("test.ppm", buffer);

  return 0;
}
